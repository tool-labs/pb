{% extends "base.html" %}

{% block page_title %}Teilnehmerinformationen für {{ user['name'] }}{% endblock %}
{% block page_heading %}Teilnehmerinformationen für <a href="https://de.wikipedia.org/wiki/Benutzer:{{ user['name'] }}" title="Benutzerseite des Teilnehmers {{ user['name'] }}">{{ user['name'] }}</a>{% endblock %}

{% block javascript %}
{% endblock %}

{% block page_body %}
<div class="row">
    <div class="col-md-6">
        <table class="table">
            <tr>
                <th><a href="#given" title="Zu den vergebenen Bestätigungen springen"><i class="glyphicon glyphicon-chevron-right"> </i> Vergebene Bestätigungen</a></th>
                <td>{{ confirmations_given | length }}</td>
            </tr>
            <tr>
                <th><a href="#taken" title="Zu den erhaltenen Bestätigungen springen"><i class="glyphicon glyphicon-chevron-right"> </i> Erhaltene Bestätigungen</a></th>
                <td>{{ confirmations_received | length }}</td>
            </tr>
        </table>
    </div>
    <div class="col-md-6">
        <table class="table">
            <tr>
                <th>Teilnehmer seit</th>
                <td>{{ user['participates_since'] | format_date }}</td>
            </tr>
            <tr>
                <th>Bestätigt seit</th>
                <td>{{ user['verified_since'] | format_date }}</td>
            </tr>
        </table>
    </div>
</div>

{% macro print_confirmation_table(confirmations, given=True) -%}
    <table class="table table-hover table-bordered tablesorter">
        <colgroup>
            <col width="30%" />
            <col width="20%" />
            <col width="40%" />
            <col width="10%" />
        </colgroup>
        <thead>
            <tr>
                <th>Benutzer</th>
                <th>Datum</th>
                <th>Kommentar</th>
                <th>Rückbestätigt?</th>
            </tr>
        </thead>
        <tbody>
            {% for confirmation in confirmations %}
                {% set back = confirmation[6] == 1 %}
                <tr class="{% if back %}success{% else %}danger{% endif %}">
                    <td class="cf-t-user"><a href="{{ url_for('user', user_name=confirmation[0]) }}" title="Details zu Teilnehmer {{ confirmation[0] }}">{{ confirmation[0] }}</a></td>
                    <td class="cf-t-date" data-string="{{ confirmation[2] }}">{{ confirmation[2] | format_date }}</td>
                    <td class="cf-t-comment">{{ confirmation[3] }}</td>
                    <td class="cf-t-back">{{ back | format_boolean }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{%- endmacro %}

<h2 id="given">Vergebene Bestätigungen</h2>

{{ print_confirmation_table(confirmations_given) }}

<h2 id="taken">Erhaltene Bestätigungen</h2>

{{ print_confirmation_table(confirmations_received, given=False) }}

{% endblock %}
